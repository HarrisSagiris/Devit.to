<!DOCTYPE html>
<html>
<head>
  <title>Reviewit-your feed</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<style>
  .post{
    text-align: center;
    color: #fff;
    padding : 20px;
  }
</style>
<body>
  <h2>Welcome to Reviewit: The best reviewing platform worldwide.</h2>
  <header>
    <% if (user) { %>
      <p>Welcome, <%= user.username %> | <a href="/logout">Logout</a> | <a href="/my-posts">My Posts</a></p>
      <form action="/post" method="post">
        <input type="text" name="title" placeholder="Title" required><br>
        <select name="category">
          <option value="Movies">Movies</option>
          <option value="Books">Books</option>
          <option value="Games">Games</option>
          <option value="General">General post</option>
        </select><br>
        <textarea name="content" placeholder="Your review" required></textarea><br>
        <button type="submit">Post</button>
      </form>
    <% } else { %>
      <a href="/login">Login</a> | <a href="/register">Register</a> 
    <% } %>
  </header>
  <section>
    <h2>Feed</h2>
    <% posts.forEach(post => { %>
      <div id="post-<%= post._id %>">
        <h3><%= post.title %> - <%= post.category %></h3>
        <p><strong>by <%= post.username %></strong></p>
        <p><%= post.content %></p>
        <p>Upvotes: <%= post.upvotes %> | Downvotes: <%= post.downvotes %></p>
        <% if (user) { %>
          <button class="upvote" data-id="<%= post._id %>">Upvote</button>
          <button class="downvote" data-id="<%= post._id %>">Downvote</button>
          <form class="comment-form" data-id="<%= post._id %>">
            <input type="text" name="content" placeholder="Add a comment" required>
            <button type="submit">Comment</button>
          </form>
        <% } %>
        <h4>Comments:</h4>
        <% post.comments.forEach(comment => { %>
          <div class="comment"><strong><%= comment.username %>:</strong> <%= comment.content %></div>
        <% }) %>
      </div>
      <hr>
    <% }) %>
  </section>
  <script src="/js/script.js"></script>
</body>
</html>